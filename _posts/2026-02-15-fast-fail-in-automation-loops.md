---
title: "자동화 루프의 역설: 실패를 빨리 알수록 빨리 끝난다"
date: 2026-02-15 00:00:00 +0900
categories: [Automation, DevOps]
tags: [automation, fail-fast, debugging, dev-loop]
---

## TL;DR

의존성 설치 실패 한 번이 6번의 반복 루프를 만든다. 자동화 루프에서 가장 비싼 비용은 "실패를 늦게 발견하는 것"이다. 빠르게 실패하고, 빠르게 개입하라.

## 배경/맥락

최근 Vite + React로 간단한 Todo 앱을 만드는 작업을 자동화 루프에 맡겼다. 요구사항은 명확했다:

- Todo CRUD
- 필터 기능
- localStorage 저장
- 빌드 검증

이론적으로 1~2번의 반복이면 충분해야 했다. 코드 생성 → 빌드 → 테스트. 끝.

그런데 실제로는 6번의 반복이 돌았다. 원인은 단 하나였다: **네트워크 실패로 인한 npm install 실패**.

## 본문

### 무슨 일이 벌어졌나

루프는 이렇게 돌았다:

1. **Iteration 1**: 코드 생성 완료 → `npm run build` 실행 → `vite: command not found`
2. **원인 파악**: Codex가 내부적으로 `npm install`을 실행했는데, `ENOTFOUND registry.npmjs.org` 에러로 실패
3. **루프의 판단**: "빌드 실패 → 코드 수정 필요" → Iteration 2 시작
4. **Iteration 2~6**: 같은 패턴 반복

코드는 문제가 없었다. 문제는 **의존성이 설치되지 않았다는 것**뿐이었다. 하지만 루프는 이를 "코드 문제"로 해석하고 계속 코드를 수정했다.

### 왜 이런 일이 발생했나

자동화 루프의 설계 결함이었다:

1. **실패 원인 분석 부재**: 빌드 실패 시 "왜 실패했나"를 먼저 물어보지 않고 바로 "코드를 수정하자"로 넘어감
2. **상태 검증 누락**: `npm install`이 성공했는지 확인하지 않고 `npm run build`부터 실행
3. **가시성 부족**: 사용자는 루프가 왜 늦어지는지 알 수 없음

결과적으로 **약 1시간의 낭비**가 발생했다.

### 어떻게 해결했나

사용자가 개입해서 직접 `npm install`을 실행했다. 그러자 바로 빌드가 통과했다.

```
npm install     # 수동 실행
npm run build   # 성공
npm test        # 5 passed
```

즉, **실패를 빨리 발견하고 빠르게 개입하는 것**만으로도 문제가 해결됐다.

## 교훈/개선

### 1. 실패를 빠르게 탐지하라

자동화 루프에 들어가기 전에 **선제 검증**을 수행해야 한다:

```bash
# 의존성 설치 확인
npm install && npm list --depth=0

# 빌드 도구 존재 확인
which vite || npm install -D vite
```

### 2. 실패 원인을 먼저 분석하라

빌드가 실패하면:

1. 로그를 읽는다
2. 에러 메시지에서 키워드를 추출한다 (`command not found`, `ENOTFOUND`, etc.)
3. 키워드에 따라 대응 전략을 결정한다
4. 그 다음에 코드를 수정한다

### 3. 가시성을 확보하라

백그라운드에서 돌아가는 루프는 **실시간 로그 중계**가 필수다. 사용자가 "왜 늦어지나"를 물어야 하는 순간에 이미 설계가 실패한 것이다.

## 체크리스트

자동화 루프를 설계할 때 확인할 것:

- [ ] **선제 검증**: 의존성/도구 설치 상태를 먼저 확인하는가?
- [ ] **실패 분석**: 실패 시 원인을 분석하는 단계가 있는가?
- [ ] **가시성**: 사용자가 실시간으로 진행 상황을 볼 수 있는가?
- [ ] **개입 지점**: 사용자가 언제든 개입할 수 있는가?
- [ ] **최대 반복 수**: 무한 루프를 방지하는 상한이 있는가?

## 참고 링크

- [Fail-fast - Wikipedia](https://en.wikipedia.org/wiki/Fail-fast)
- [The Fallacies of Distributed Computing](https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing)
