---
title: "Codex 24시간 개발 루프 설계안: 작업큐·중단조건·비용상한·PR 게이트·실패복구"
date: 2026-02-15 23:30:00 +0900
categories: [Josu Log, Automation]
tags: [codex, ai-agent, automation, ci-cd, pr, operations]
---

## TL;DR
"에이전트가 밤새 개발"은 가능하다. 다만 성공 패턴은 완전 무인 개발이 아니라 **무인 실행 + 인간 승인 게이트**다.  
핵심은 다섯 가지다: **작업큐, 중단조건, 비용상한, PR 게이트, 실패복구**.

## 배경/맥락
요즘 가장 자주 받는 질문이 이거다.

> "Codex로 24시간 돌리면 next step도 알아서 판단해서 계속 개발할 수 있나요?"

답은 "된다"다. 하지만 그다음 문장이 더 중요하다.

> "운영 설계 없이 돌리면, 속도보다 사고가 먼저 난다."

AI 코딩 에이전트는 피곤함이 없어서 계속 달린다. 문제는 방향이 틀어졌을 때도 계속 달린다는 점이다. 그래서 24시간 루프의 본질은 생성 능력이 아니라 **제어 능력**이다.

## 1) 작업큐: 에이전트에게 "큰 목표" 말고 "작은 배치"를 준다
에이전트가 스스로 next step을 판단하게 하려면, 먼저 작업 단위를 잘게 쪼개야 한다. "결제 시스템 완성" 같은 목표를 한 번에 던지면 품질이 무너진다.

내 기준은 아래다.

- 한 작업은 **30~90분 내 완료 가능한 크기**
- 완료 조건은 테스트/린트/빌드처럼 **기계 판정 가능**
- 다음 작업은 직전 결과를 읽고 큐에서 자동 선택

작업큐 상태는 최소 `queued → running → blocked → review → done`으로 둔다.  
이렇게 해두면 에이전트는 막히면 멈추고, 통과하면 다음 배치로 넘어간다.

That said, "자율성"은 큐가 정교할수록 커진다. 역설적이지만 사실이다.

## 2) 중단조건: 잘 돌아가는 것보다 잘 멈추는 게 먼저다
24시간 루프에서 가장 중요한 건 시작이 아니라 멈춤이다.

중단조건은 코드처럼 명시해야 한다.

- 동일 테스트 3회 연속 실패
- 동일 파일/함수에서 5회 이상 왕복 수정
- 에러 원인 불명 상태로 45분 초과
- 테스트 커버리지/성능 지표가 기준 이하로 하락

이 조건 중 하나라도 맞으면 에이전트는 "계속 시도"가 아니라 `blocked`로 전환하고 사람에게 넘긴다.  
이 규칙 하나로 무의미한 토큰 소모와 새벽 대참사를 대부분 막을 수 있다.

## 3) 비용상한: 예산은 기술문제가 아니라 운영문제다
에이전트는 문제를 풀기 시작하면 끝까지 물고 늘어진다. 그래서 **시간 상한 + 비용 상한**을 같이 둬야 한다.

권장 가드레일:

- 1회 실행 최대 시간: 20~40분
- 일일 최대 실행 횟수: 예) 24~48회
- 일일 토큰/비용 캡: 예) 초과 시 자동 pause
- 고난도 작업은 저가 모델 탐색 후, 필요할 때만 상위 모델 승급

핵심은 "잘하면 더 쓰고, 못하면 끊는다"가 아니라, **예산 안에서만 학습하도록 설계**하는 것이다.

## 4) PR 게이트: 머지는 사람이 한다
현실적인 24시간 개발 파이프라인은 대부분 이 구조다.

1. 에이전트가 브랜치에서 구현
2. 테스트/린트/정적분석 통과
3. PR 생성 + 변경 이유/리스크 요약
4. 사람이 리뷰 후 머지

여기서 절대 빼면 안 되는 게 PR 템플릿이다.

- "무엇을 바꿨는가"
- "왜 바꿨는가"
- "어떤 테스트로 검증했는가"
- "롤백은 어떻게 하는가"

이 4개를 강제하면, 아침 리뷰 시간이 극적으로 줄어든다.  
속도는 에이전트가 만들고, 최종 책임은 인간이 가진다.

## 5) 실패복구: 복구 시나리오가 없으면 자동화가 아니다
실패는 예외가 아니라 기본값이다. 그래서 복구가 설계의 중심이어야 한다.

최소 복구 세트:

- 실패 시 자동 스냅샷(로그/디프/테스트 결과)
- 자동 롤백 기준(성능 저하, 핵심 테스트 깨짐)
- 재시도 정책(즉시 1회, 지수 백오프 2회 등)
- 반복 실패 패턴은 큐에서 자동 격리

그리고 운영 로그는 "성공 로그"보다 "실패 로그"를 더 자세히 남겨야 한다. 다음 루프의 품질은 실패 기록에서 나온다.

## 바로 적용 가능한 운영 템플릿
오늘 당장 붙일 수 있는 최소 템플릿은 이렇다.

- **낮(사람 온라인)**: 큰 작업 분해 + 우선순위 큐 정리
- **밤(무인)**: 에이전트 배치 실행 + PR 생성까지만
- **아침(사람 복귀)**: PR 묶음 리뷰 + 머지 + 큐 재정렬

한 줄로 말하면, 밤에는 "작성", 아침에는 "승인"이다.

## 결론
24시간 루프의 질문은 "AI가 코드를 쓸 수 있나"가 아니다.  
진짜 질문은 "**우리 팀이 리스크를 통제하면서 계속 배포할 수 있나**"다.

Codex는 충분히 강력하다. 하지만 강력한 도구일수록 규칙이 먼저다.  
작업큐, 중단조건, 비용상한, PR 게이트, 실패복구. 이 다섯 가지만 먼저 고정하면, "자는 동안 개발"은 실험이 아니라 운영이 된다.

## 체크리스트
- [x] 작업을 30~90분 단위 배치로 분해
- [x] 중단조건(반복 실패/시간 초과/품질 하락) 명시
- [x] 일일 비용/토큰 상한 설정
- [x] PR 생성 후 인간 승인 게이트 유지
- [x] 실패 스냅샷/롤백/재시도 정책 문서화

## 참고 링크
- <https://docs.github.com/en/copilot/concepts/agents/coding-agent/about-coding-agent>
- <https://github.blog/changelog/2025-10-28-ask-copilot-coding-agent-to-make-changes-in-any-pull-request-with-copilot/>
- <https://openhands.dev/blog/openhands-index>
- <https://resources.anthropic.com/2026-agentic-coding-trends-report>
